(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{576:function(e,t,s){"use strict";s.r(t);var a=s(40),n=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"deploying-a-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deploying-a-server"}},[e._v("#")]),e._v(" Deploying a Server")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("IMPORTANT")]),e._v(" "),s("p",[e._v("We offer a free server that you can use straight away (create accounts, etc.).")]),e._v(" "),s("p",[e._v("We can also help you manage your Server deployments (setting things up securely, automatic upgrades, support, etc)")]),e._v(" "),s("p",[e._v("See "),s("a",{attrs:{href:"https://speckle.systems/getstarted/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://speckle.systems/getstarted/"),s("OutboundLink")],1),e._v(" for more details on our offerings.")])]),e._v(" "),s("p",[e._v("If you want to run your own instance, there are multiple ways to achieve this:")]),e._v(" "),s("ul",[s("li",[e._v("The easiest way is to use our precompiled releases that are available as docker images on Docker Hub.")]),e._v(" "),s("li",[e._v("If you want to deploy the Server with your own modifications, you should build your own docker images (instructions below).")]),e._v(" "),s("li",[e._v("Also, you can run the Server with local development tools needed for each package (requires development knowledge)")])]),e._v(" "),s("h3",{attrs:{id:"dependencies"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dependencies"}},[e._v("#")]),e._v(" Dependencies")]),e._v(" "),s("p",[e._v("The Speckle server needs two services available over the network:")]),e._v(" "),s("ul",[s("li",[e._v("PostgreSQL (tested with v12 and v13)")]),e._v(" "),s("li",[e._v("Redis")])]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),s("p",[e._v("Both PostgreSQL and Redis are included in the following deployment instructions, so "),s("strong",[e._v("you don't need to install them manually")]),e._v(".")]),e._v(" "),s("p",[e._v("You can also install them manually or use a managed deployment from a cloud provider (Azure, AWS, DigitalOcean, etc). Setting them up manually is out of scope of this article.")])]),e._v(" "),s("h2",{attrs:{id:"run-in-a-virtual-machine"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#run-in-a-virtual-machine"}},[e._v("#")]),e._v(" Run in a Virtual Machine")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("IMPORTANT")]),e._v(" "),s("p",[e._v("This setup is not recommended for use in production, if you need help deploying a production server, "),s("a",{attrs:{href:"https://speckle.systems/getstarted/",target:"_blank",rel:"noopener noreferrer"}},[e._v("we can help"),s("OutboundLink")],1),e._v("!")])]),e._v(" "),s("p",[e._v("This is the easiest way to get the Server running.")]),e._v(" "),s("p",[e._v("As prerequisites, you only need a Linux VM and have "),s("a",{attrs:{href:"https://docs.docker.com/engine/install/ubuntu/#install-using-the-convenience-script",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker"),s("OutboundLink")],1),e._v(" and "),s("a",{attrs:{href:"https://docs.docker.com/compose/install/#install-compose-on-linux-systems",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker Compose"),s("OutboundLink")],1),e._v(" installed.")]),e._v(" "),s("h4",{attrs:{id:"step-1-create-a-directory-for-this-deployment-on-the-system"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-1-create-a-directory-for-this-deployment-on-the-system"}},[e._v("#")]),e._v(" Step 1: Create a directory for this deployment on the system:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("# mkdir /opt/speckle/\n")])])]),s("h4",{attrs:{id:"step-2-copy-and-paste-this-into-a-file-named-docker-compose-yml-in-your-directory"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-2-copy-and-paste-this-into-a-file-named-docker-compose-yml-in-your-directory"}},[e._v("#")]),e._v(" Step 2: Copy and paste this into a file named "),s("code",[e._v("docker-compose.yml")]),e._v(" in your directory:")]),e._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"3"')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("####")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Speckle Server dependencies")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#######")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("postgres")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"postgres:13.1-alpine"')]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("POSTGRES_DB")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" speckle\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("POSTGRES_USER")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" speckle\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("POSTGRES_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" speckle\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" ./postgres"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("/var/lib/postgresql/data/\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"127.0.0.1:5432:5432"')]),e._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("redis")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"redis:6.0-alpine"')]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("volumes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" ./redis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("data"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("/data\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"127.0.0.1:6379:6379"')]),e._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("####")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Speckle Server")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#######")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("speckle-frontend")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" speckle/speckle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("frontend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0.0.0.0:80:80"')]),e._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("speckle-server")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" speckle/speckle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("server"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"bash"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"-c"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"/wait && node bin/www"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# TODO: Change this to the URL of the speckle server, as accessed from the network")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("CANONICAL_URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"http://localhost"')]),e._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# TODO: Change this to a unique secret for this server")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("SESSION_SECRET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"TODO:ReplaceWithLongString"')]),e._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("STRATEGY_LOCAL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"true"')]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("DEBUG")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"speckle:*"')]),e._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("POSTGRES_URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"postgres"')]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("POSTGRES_USER")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"speckle"')]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("POSTGRES_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"speckle"')]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("POSTGRES_DB")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"speckle"')]),e._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("REDIS_URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"redis://redis"')]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("WAIT_HOSTS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" postgres"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("5432")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(",")]),e._v(" redis"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("6379")]),e._v("\n\n")])])]),s("h4",{attrs:{id:"step-3-edit-the-fields-marked-with-todo"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-3-edit-the-fields-marked-with-todo"}},[e._v("#")]),e._v(" Step 3: Edit the fields marked with "),s("code",[e._v("TODO")])]),e._v(" "),s("p",[e._v("Make sure to edit the file and change")]),e._v(" "),s("ul",[s("li",[s("code",[e._v("CANONICAL_URL")]),e._v(" to the url used to access this speckle server. This can be "),s("code",[e._v("http://[PUBLIC_IP]")]),e._v(" or "),s("code",[e._v("http://[DOMAIN_NAME]")])]),e._v(" "),s("li",[e._v("For added security, change the "),s("code",[e._v("SESSION_SECRET")]),e._v(" to a unique secret value for this deployment.")])]),e._v(" "),s("p",[e._v("The server also supports some other environment variables. You can see them in our "),s("a",{attrs:{href:"https://github.com/specklesystems/speckle-server/blob/main/packages/server/.env-example",target:"_blank",rel:"noopener noreferrer"}},[e._v(".env-example file from the git repo"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("h4",{attrs:{id:"step-4-start-the-server-and-the-dependencies"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-4-start-the-server-and-the-dependencies"}},[e._v("#")]),e._v(" Step 4: Start the Server and the dependencies")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# cd /opt/speckle")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# docker-compose up -d")]),e._v("\n")])])]),s("p",[e._v("This will:")]),e._v(" "),s("ul",[s("li",[e._v("Run PostgreSQL inside docker, with data files stored in "),s("code",[e._v("/opt/speckle/postgres-data/")])]),e._v(" "),s("li",[e._v("Run Redis inside docker, with data files stored in "),s("code",[e._v("/opt/speckle/redis-data/")])]),e._v(" "),s("li",[e._v("Run the Server component, configured for this environment.")]),e._v(" "),s("li",[e._v("Run the Frontend component, exposing port 80 to the network the VM is in.")])]),e._v(" "),s("p",[e._v("All containers, except the frontend, are not accessible from outside the VM.")]),e._v(" "),s("p",[e._v("All containers automatically start at system startup (so if the VM gets rebooted, the Server will automatically start)")]),e._v(" "),s("h2",{attrs:{id:"run-in-a-vm-without-dependencies"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#run-in-a-vm-without-dependencies"}},[e._v("#")]),e._v(" Run in a VM without dependencies")]),e._v(" "),s("p",[e._v("If you plan to run PostgreSQL and Redis separately, for example as managed deployments by a cloud provider (DigitalOcean, AWS, Azure, etc), you can follow the same instructions as above, but with this simplified "),s("code",[e._v("docker-compose.yml")]),e._v(" file:")]),e._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"3"')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("speckle-frontend")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" speckle/speckle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("frontend"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"0.0.0.0:80:80"')]),e._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("speckle-server")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" speckle/speckle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("-")]),e._v("server"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("latest\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# TODO: Change this to the URL of the speckle server, as accessed from the network")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("CANONICAL_URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"http://localhost"')]),e._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# TODO: Change this to a unique secret for this server")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("SESSION_SECRET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"TODO:ReplaceWithLongString"')]),e._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("STRATEGY_LOCAL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"true"')]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("DEBUG")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"speckle:*"')]),e._v("\n\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# TODO: Change to PostgreSQL connection details:")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("POSTGRES_URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"postgres"')]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("POSTGRES_USER")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"speckle"')]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("POSTGRES_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"speckle"')]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("POSTGRES_DB")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"speckle"')]),e._v("\n      \n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# TODO: Change to redis connection string:")]),e._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[e._v("REDIS_URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(":")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"redis://redis"')]),e._v("\n\n")])])]),s("h2",{attrs:{id:"run-your-speckle-server-fork"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#run-your-speckle-server-fork"}},[e._v("#")]),e._v(" Run your speckle-server fork")]),e._v(" "),s("p",[e._v("If you made some changes to the server and want to run those instead of the official releases, we created some useful docker-compose .yml files to help with that.")]),e._v(" "),s("h4",{attrs:{id:"step-1-set-up-dependencies"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-1-set-up-dependencies"}},[e._v("#")]),e._v(" Step 1: Set up dependencies")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),s("p",[e._v("If you set up PostgreSQL or Redis outside of this VM (for example a managed deployment from a cloud provider), you can skip this step, but remember to set up the correct environment variables later")])]),e._v(" "),s("p",[e._v("To get the PostgreSQL and Redis dependencies up and running in the VM, our git repo contains\n"),s("a",{attrs:{href:"https://github.com/specklesystems/speckle-server/blob/main/docker-compose-deps.yml",target:"_blank",rel:"noopener noreferrer"}},[e._v("a docker-compose file"),s("OutboundLink")],1),e._v("\nfor running these dependencies locally in docker containers.")]),e._v(" "),s("p",[e._v("It also includes "),s("code",[e._v("PGAdmin")]),e._v(" and "),s("code",[e._v("redis-insight")]),e._v(" to be able to explore the raw data. If you don't need them, you can safely remove those entries from the "),s("code",[e._v("docker-compose-deps.yml")]),e._v(" file.")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("PATH_TO_SPECKLE-SERVER_REPOSITORY"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n$ docker-compose -f docker-compose-deps.yml up -d\n")])])]),s("p",[e._v("This will run the following containers, and will automatically launch them at system startup:")]),e._v(" "),s("ul",[s("li",[s("em",[e._v("PostgreSQL v13")]),e._v(", listening only on "),s("code",[e._v("127.0.0.1:5432")]),e._v(" with default credentials "),s("code",[e._v("speckle")]),e._v(":"),s("code",[e._v("speckle")]),e._v(" and a database named "),s("code",[e._v("speckle")]),e._v(".")]),e._v(" "),s("li",[s("em",[e._v("Redis v6")]),e._v(", listening only on "),s("code",[e._v("127.0.0.1:6379")])]),e._v(" "),s("li",[s("em",[e._v("PGAdmin4")]),e._v(", listening only on "),s("code",[e._v("127.0.0.1:16543")]),e._v(" with default credentials "),s("code",[e._v("admin@localhost")]),e._v(" : "),s("code",[e._v("admin")])]),e._v(" "),s("li",[s("em",[e._v("Redis Insight")]),e._v(", listening only on "),s("code",[e._v("127.0.0.1:8001")])])]),e._v(" "),s("p",[e._v("All of the above containers listen on the local loopback interface ("),s("code",[e._v("127.0.0.1")]),e._v(") and are NOT accessible from the local network (for security, since they use default credentials)")]),e._v(" "),s("p",[e._v("To use PGAdmin, after login you can configure a server connection to the host "),s("code",[e._v("postgres")]),e._v(" (user "),s("code",[e._v("speckle")]),e._v(", password "),s("code",[e._v("speckle")]),e._v(", database "),s("code",[e._v("speckle")]),e._v(")")]),e._v(" "),s("p",[e._v("To use Redis Insight, you can configure it to connect to the hostname "),s("code",[e._v("redis")]),e._v(" (port "),s("code",[e._v("6379")]),e._v(")")]),e._v(" "),s("p",[e._v("Docker-compose creates named docker volumes for storing data for each of the containers, so data is persisted.\nYou can view existing docker volumes with "),s("code",[e._v("docker volume ls")]),e._v(" and delete a volume and existing data with "),s("code",[e._v("docker volume rm [volume_name]")])]),e._v(" "),s("h4",{attrs:{id:"step-2-build-and-run-your-code"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-2-build-and-run-your-code"}},[e._v("#")]),e._v(" Step 2: Build and run your code")]),e._v(" "),s("p",[e._v("The git repository contains "),s("a",{attrs:{href:"https://github.com/specklesystems/speckle-server/blob/main/docker-compose-speckle.yml",target:"_blank",rel:"noopener noreferrer"}},[e._v("a docker-compose file"),s("OutboundLink")],1),e._v(" for building and running the Speckle server frontend and backend in docker containers.")]),e._v(" "),s("p",[e._v("To use it, first edit the variables in the "),s("code",[e._v("docker-compose-speckle.yml")]),e._v(" file to reflect your environment. Then, you can start them with:")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("PATH_TO_SPECKLE-SERVER_REPOSITORY"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n$ docker-compose -f docker-compose-speckle.yml up --build -d\n")])])]),s("p",[e._v("(You can safely ignore the warnings about the "),s("em",[e._v("orphan containers")]),e._v(")")]),e._v(" "),s("p",[e._v("This will run the following containers, and will automatically launch them at system startup:")]),e._v(" "),s("ul",[s("li",[s("em",[e._v("speckle-frontend")]),e._v(", an nginx container that serves the Vue app build as static files (exposed on port 80 in the VM network) and proxies server requests to the "),s("code",[e._v("speckle-server")]),e._v(" container")]),e._v(" "),s("li",[s("em",[e._v("speckle-server")]),e._v(", the "),s("code",[e._v("server")]),e._v(" component that doesn't expose any port outside the internal docker network.")])]),e._v(" "),s("h2",{attrs:{id:"run-in-development-mode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#run-in-development-mode"}},[e._v("#")]),e._v(" Run in development mode")]),e._v(" "),s("p",[e._v("This is the recommended method for developing or debugging the Speckle Server locally.")]),e._v(" "),s("p",[e._v("If you plan to give others access to your Server instance, consider running it with production settings in a dedicated virtual machine (see previous section)")]),e._v(" "),s("p",[e._v("To run the Speckle Server, you need to run:")]),e._v(" "),s("ul",[s("li",[e._v("the "),s("code",[e._v("frontend")]),e._v(" package (see "),s("a",{attrs:{href:"https://github.com/specklesystems/speckle-server/tree/main/packages/frontend",target:"_blank",rel:"noopener noreferrer"}},[e._v("the readme.md file in the git repo"),s("OutboundLink")],1),e._v(")")]),e._v(" "),s("li",[e._v("the "),s("code",[e._v("server")]),e._v(" package (see "),s("a",{attrs:{href:"https://github.com/specklesystems/speckle-server/tree/main/packages/server",target:"_blank",rel:"noopener noreferrer"}},[e._v("the readme.md file in the git repo"),s("OutboundLink")],1),e._v(")")])]),e._v(" "),s("p",[e._v("Detailed instructions for running them locally are kept up to date in their respective readme.md files.")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("IMPORTANT")]),e._v(" "),s("p",[e._v("Don't forget to set up the variables in the "),s("code",[e._v(".env")]),e._v(" file according to your deployment. You can get started by copying the "),s("code",[e._v(".env-example")]),e._v(" file to "),s("code",[e._v(".env")]),e._v(" and then edit it.")])]),e._v(" "),s("p",[e._v("In this deployment type, the frontend Vue app will listen by default on the local interface (not available over the network) on "),s("code",[e._v("port 8080")]),e._v(", but will have no knowledge about the "),s("code",[e._v("server")]),e._v(" component, and thus "),s("strong",[e._v("should not be accessed directly")]),e._v(".")]),e._v(" "),s("p",[e._v("The server component will listen on the local interface (not available over the network) on "),s("code",[e._v("port 3000")]),e._v(", and will proxy the frontend requests to the frontend component (as configured in .env file).")]),e._v(" "),s("p",[e._v("You can access Speckle Web from your browser at "),s("a",{attrs:{href:"http://localhost:3000/",target:"_blank",rel:"noopener noreferrer"}},[e._v("http://localhost:3000/"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("p",[e._v("If you plan to access the development server over the network, you should update the "),s("code",[e._v("CANONICAL_URL")]),e._v(" variable in the .env file to the URL that is used to access the server, and also set the "),s("code",[e._v("BIND_ADDRESS")]),e._v(" env variable to "),s("code",[e._v("0.0.0.0")]),e._v(".")])])}),[],!1,null,null,null);t.default=n.exports}}]);